# Events Table (Collection) Structure

## ğŸ“Š Firestore Collection: `events`

Each event is stored as a **document** in the `events` collection with the following fields:

---

## ğŸ—‚ï¸ Event Document Structure

```javascript
events/{eventId}
  â”œâ”€â”€ id: string (auto-generated by Firestore)
  â”œâ”€â”€ title: string (required)
  â”œâ”€â”€ sport: string (optional)
  â”œâ”€â”€ date: string (required, format: "YYYY-MM-DD")
  â”œâ”€â”€ time: string (required, format: "HH:MM")
  â”œâ”€â”€ endTime: string (optional, format: "HH:MM")
  â”œâ”€â”€ location: string (required)
  â”œâ”€â”€ maxParticipants: number (required)
  â”œâ”€â”€ participants: string[] (array of user IDs)
  â”œâ”€â”€ creatorId: string (required, user ID who created event)
  â”œâ”€â”€ description: string (optional)
  â””â”€â”€ createdAt: timestamp (auto-added by system)
```

---

## ğŸ“ Field Details

| Field | Type | Required | Description | Example |
|-------|------|----------|-------------|---------|
| **id** | string | âœ… | Auto-generated document ID | `"abc123xyz"` |
| **title** | string | âœ… | Event name | `"Morning Basketball"` |
| **sport** | string | âŒ | Type of sport/activity | `"Basketball"` |
| **date** | string | âœ… | Event date | `"2025-12-01"` |
| **time** | string | âœ… | Start time | `"09:00"` |
| **endTime** | string | âŒ | End time | `"11:00"` |
| **location** | string | âœ… | Where event happens | `"Central Park"` |
| **maxParticipants** | number | âœ… | Maximum people allowed | `10` |
| **participants** | string[] | âœ… | Array of user IDs who joined | `["1", "2", "3"]` |
| **creatorId** | string | âœ… | User ID who created event | `"1"` |
| **description** | string | âŒ | Detailed event info | `"Friendly game..."` |
| **createdAt** | timestamp | âœ… | When event was created | `Timestamp(...)` |

---

## ğŸ“‹ Example Event Document

Here's what an actual event looks like in Firestore:

```json
{
  "id": "Kx7mP2nQ8rT5vW9z",
  "title": "Morning Basketball",
  "sport": "Basketball",
  "date": "2025-12-01",
  "time": "09:00",
  "endTime": "11:00",
  "location": "Central Park",
  "maxParticipants": 10,
  "participants": ["1", "2"],
  "creatorId": "1",
  "description": null,
  "createdAt": {
    "_seconds": 1701234567,
    "_nanoseconds": 123456789
  }
}
```

---

## ğŸ” How Data is Used

### When Creating an Event:
```typescript
// User fills out form in CreateEventScreen
{
  title: "Evening Soccer Match",
  sport: "Soccer",
  date: "2025-12-02",
  time: "18:00",
  endTime: "20:00",
  location: "Sports Complex",
  maxParticipants: 22,
  participants: ["1"], // Creator auto-joins
  creatorId: "1"
}
```

### When Joining an Event:
```typescript
// User clicks "Join Event" button
// System updates the participants array:
participants: ["1", "2", "3"] // New user ID added
```

### When Browsing Events:
```typescript
// App fetches all events, sorted by date
// Displays in EventsScreen with:
- Event icon (based on title/sport)
- Title
- Date and time
- Location
- Participant count (e.g., "3/10 joined")
```

---

## ğŸ¯ Data Flow

```
User Action                 Firestore Operation
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Create Event    â”€â”€â”€â”€â”€â”€â–º    addDoc(events, {...})
                           â””â”€â”€ New document created
                           â””â”€â”€ createdAt timestamp added
                           â””â”€â”€ Returns document ID

Join Event      â”€â”€â”€â”€â”€â”€â–º    updateDoc(events/id, {
                             participants: arrayUnion(userId)
                           })
                           â””â”€â”€ Adds user to participants array

Browse Events   â—„â”€â”€â”€â”€â”€â”€    getDocs(query(events, 
                             orderBy('date', 'asc')
                           ))
                           â””â”€â”€ Returns all events sorted by date

View Schedule   â—„â”€â”€â”€â”€â”€â”€    Filter events where
                           participants.includes(userId)
                           â””â”€â”€ Shows only user's events
```

---

## ğŸ“Š Sample Data in Firestore

When you seed data, here's what gets created:

### Event 1:
```
Document ID: (auto-generated)
â”œâ”€â”€ title: "Morning Basketball"
â”œâ”€â”€ sport: "Basketball"
â”œâ”€â”€ date: "2025-12-01"
â”œâ”€â”€ time: "09:00"
â”œâ”€â”€ endTime: "11:00"
â”œâ”€â”€ location: "Central Park"
â”œâ”€â”€ maxParticipants: 10
â”œâ”€â”€ participants: ["1", "2"]
â”œâ”€â”€ creatorId: "1"
â””â”€â”€ createdAt: (timestamp)
```

### Event 2:
```
Document ID: (auto-generated)
â”œâ”€â”€ title: "Evening Soccer Match"
â”œâ”€â”€ sport: "Soccer"
â”œâ”€â”€ date: "2025-12-02"
â”œâ”€â”€ time: "18:00"
â”œâ”€â”€ endTime: "20:00"
â”œâ”€â”€ location: "Sports Complex"
â”œâ”€â”€ maxParticipants: 22
â”œâ”€â”€ participants: ["1"]
â”œâ”€â”€ creatorId: "2"
â””â”€â”€ createdAt: (timestamp)
```

---

## ğŸ” Viewing in Firebase Console

To see your events table:

1. Go to [Firebase Console](https://console.firebase.google.com/)
2. Select your project: **eventbuddy-5c0bd**
3. Click **Firestore Database**
4. You'll see the `events` collection
5. Click on any document to see all fields

**Screenshot view:**
```
Firestore Database
â””â”€â”€ events (collection)
    â”œâ”€â”€ Kx7mP2nQ8rT5vW9z (document)
    â”‚   â”œâ”€â”€ title: "Morning Basketball"
    â”‚   â”œâ”€â”€ sport: "Basketball"
    â”‚   â”œâ”€â”€ date: "2025-12-01"
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ Lm8nR3oS9uV6xY0a (document)
    â””â”€â”€ Mn9oT4pU0wX7zB1c (document)
```

---

## ğŸ”„ CRUD Operations

### Create (Add Event)
```typescript
import { createEvent } from '../services/eventService';

await createEvent({
  title: "Tennis Practice",
  sport: "Tennis",
  date: "2025-12-03",
  time: "14:00",
  endTime: "16:00",
  location: "City Tennis Courts",
  maxParticipants: 4,
  participants: ["1"],
  creatorId: "1"
});
```

### Read (Get All Events)
```typescript
import { fetchEvents } from '../services/eventService';

const events = await fetchEvents();
// Returns array of all events, sorted by date
```

### Update (Join Event)
```typescript
import { joinEventInFirestore } from '../services/eventService';

await joinEventInFirestore("eventId123", "userId456");
// Adds userId456 to participants array
```

### Delete
Currently not implemented, but would be:
```typescript
import { deleteDoc, doc } from 'firebase/firestore';
import { db } from '../config/firebase';

await deleteDoc(doc(db, 'events', eventId));
```

---

## ğŸ“ˆ Storage Size

Each event document is approximately:
- **~500 bytes** for basic event data
- **+50 bytes** per participant in array
- **+100 bytes** for timestamps

**Example:**
- Event with 10 participants â‰ˆ 1 KB
- 1000 events â‰ˆ 1 MB

Firestore free tier: **1 GB storage** (plenty!)

---

## ğŸ¨ UI Display

### Events Screen:
Shows each event as a card with:
- ğŸ€ Sport icon (emoji based on title)
- **Title** (bold)
- â° Time range (start - end)
- ğŸ“ Location
- ğŸ‘¥ Participants count (e.g., "3/10 joined")
- ğŸ“… Date box (month, day, year)

### Event Detail Screen:
Shows full event information:
- All fields from the document
- Join button (if not full)
- Chat button

### Schedule Screen:
Filters events where:
- `participants.includes(currentUserId)`
- Separates into Active (future) and Archive (past)

---

## ğŸ’¡ Key Points

1. **Auto-generated IDs**: Firestore creates unique IDs for each event
2. **Participants Array**: Stores user IDs, not full user objects
3. **Date Format**: Stored as string "YYYY-MM-DD" for easy sorting
4. **Time Format**: Stored as string "HH:MM" (24-hour format)
5. **Creator Auto-joins**: When creating event, creator is added to participants
6. **Timestamps**: System automatically adds createdAt timestamp

---

## ğŸ” Security

Current rules allow:
- âœ… Anyone can read events (public browsing)
- âœ… Authenticated users can create events
- âœ… Authenticated users can update events (for joining)
- âœ… Only creator can delete their event

See `FIRESTORE_SECURITY_RULES.md` for details.

---

## â“ FAQ

**Q: Where is the event ID stored?**
A: It's the Firestore document ID, also copied to the `id` field for convenience.

**Q: Why store participants as IDs instead of full user objects?**
A: To avoid data duplication and keep documents small. User details are fetched separately when needed.

**Q: Can I add more fields?**
A: Yes! Just update the Event interface in `src/types/index.ts` and the fields will be saved automatically.

**Q: What happens if maxParticipants is reached?**
A: The join button is disabled and shows "Event Full".

**Q: How are events sorted?**
A: By date (ascending), then by time. Oldest events first.

---

## ğŸ“ Summary

The **events** collection stores all event information with:
- âœ… 11 fields per event
- âœ… Auto-generated IDs
- âœ… Participant tracking
- âœ… Timestamps for creation
- âœ… Optional description field
- âœ… Simple, clean structure

This structure supports all current features and is easy to extend!
